@layer common-button, icon-button, button-shared, button-toggle-shared, button-active, button-disabled;

@layer button-shared {
  :host {
    --_on-color: var(--md-sys-color-on-primary);
    --_color: var(--md-sys-color-primary);
    /* [size=small] */
    --_h: 40px; /* height */
    --_icon-size: 20px;
    --_rad-sq: 12px; /* square-radius */
    --_rad-pr: 8px; /* pressed-radius */

    --_text-color: var(--_on-color);
    --_background-color: var(--_color);
    --_outline-color: var(--md-sys-color-outline-variant);

    align-items: center;
    box-sizing: border-box;
    cursor: pointer;
    display: inline-flex;
    flex-shrink: 0;
    height: var(--_h);
    justify-content: center;
    outline: 0;
    position: relative;
    -webkit-tap-highlight-color: transparent;
    -webkit-user-select: none;
    user-select: none;
    vertical-align: top;
  }

  :host([size='xsmall']) {
    --_h: 32px;
  }
  :host([size='medium']) {
    --_h: 56px;
    --_icon-size: 24px;
    --_rad-sq: 16px;
    --_rad-pr: 12px;
  }
  :host([size='large']) {
    --_h: 96px;
    --_icon-size: 32px;
    --_rad-sq: 28px;
    --_rad-pr: 16px;
  }
  :host([size='xlarge']) {
    --_h: 136px;
    --_icon-size: 40px;
    --_rad-sq: 28px;
    --_rad-pr: 16px;
  }

  :host([color='secondary']) {
    --_on-color: var(--md-sys-color-on-secondary);
    --_color: var(--md-sys-color-secondary);
  }
  :host([color='tertiary']) {
    --_on-color: var(--md-sys-color-on-tertiary);
    --_color: var(--md-sys-color-tertiary);
  }

  :host([variant='tonal']) {
    --_background-color: var(--md-sys-color-secondary-container);
    --_text-color: var(--md-sys-color-on-secondary-container);
  }
  :host([variant='outlined']) {
    --_background-color: transparent;
    --_text-color: var(--md-sys-color-on-surface-variant);
    --md-focus-ring-offset: 3px;
    border-color: color-mix(
      in srgb,
      var(--_outline-color) var(--_outline-opacity, 100%),
      transparent
    );
    border-style: solid;
    border-width: 1px;
    box-shadow: none;
  }
  :host([variant='text']) {
    --_background-color: transparent !important;
    --_text-color: var(--_color);
  }

  :host([shape='square']) {
    --md-focus-ring-shape: var(--_rad-sq);
    border-radius: var(--_rad-sq);
  }
}

@layer button-active {
  /* TODO: Space key pressed should also trigger active state */
  :host(:active) {
    --md-focus-ring-shape: var(--_rad-pr);
    border-radius: var(--_rad-pr);
  }
}

@layer button-disabled {
  :host([variant='outlined']:disabled) {
    --_background-color: var(--md-sys-color-outline);
  }

  :host(:disabled),
  :host([variant='outlined']:state(checked):disabled) {
    --_background-color: var(--md-sys-color-on-surface);
    --_background-opacity: 10%;
    --_text-color: var(--md-sys-color-on-surface);
    --_text-opacity: 38%;
    --_outline-color: var(--md-sys-color-on-surface);
    --_outline-opacity: 10%;
    box-shadow: none;
    pointer-events: none;
  }
}
